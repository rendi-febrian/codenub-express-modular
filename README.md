# codenub-express-modular (cem)

> **Scaffold modular, type-safe Express applications with Clean Architecture & Prisma support in seconds.**

`cem` is a powerful CLI tool designed to bring the structure and scalability of NestJS to the flexibility of Express. It enforces a modular Clean Architecture, integrates Prisma ORM seamlessly, and automates repetitive boilerplate.

## Key Features

*   **Modular Architecture**: Automatically generates modules with Controller, Service, Repository, and DTO layers.
*   **Clean Architecture**: Separation of concerns (Presentation, Application, Domain, Infrastructure).
*   **Prisma Integration**: First-class support for Prisma ORM (`cem prisma:init`, `cem prisma:generate`).
*   **Type-Safe**: Full TypeScript support out of the box.
*   **Lightweight**: No heavy runtime framework overhead, just pure Express with better structure.

## Installation

Install globally via npm:

```bash
npm install -g codenub-express-modular
```

Or run directly with `npx`:

```bash
npx codenub-express-modular init my-app
```

## Quick Start

### 1. Initialize a New Project

```bash
cem init my-awesome-app
cd my-awesome-app
npm install
```

This creates a production-ready Express app with the following structure:
```
src/
├── common/         # Shared middlewares, guards, utils
├── config/         # Environment configuration
├── modules/        # Feature modules
│   └── index/      # Default module
├── app.ts          # App configuration
└── main.ts         # Entry point
```

### 2. Setup Prisma

Initialize Prisma and generate the client:

```bash
cem prisma init
```

### 3. Generate a Resource

Create a new `User` module with all necessary layers:

```bash
cem create module user
```

## CLI Commands

### `cem init <projectName>`
Initializes a new project.
*   Prompts for name if not provided.
*   Sets up TypeScript, Express, and folder structure.

### `cem create module <name>`
Generates a full module structure:
*   `src/modules/<name>/<name>.controller.ts`
*   `src/modules/<name>/<name>.service.ts`
*   `src/modules/<name>/<name>.repository.ts`
*   `src/modules/<name>/dto/<name>.dto.ts`
*   **Special Templates**:
    *   `cem create module user`: Offers Standard User Template (with email/password).
    *   `cem create module auth`: Offers Standard Auth Template (Login/Register).

### `cem create` (Interactive & Smart)
*   **No Arguments**: Run `cem create` to follow interactive prompts for everything.
*   **Smart Detection**: Run `cem create my-feature` -> CLI detects "my-feature" is not a type, so it assumes it's the **Name** and asks for the **Type**.

### `cem create service <name>`
Generates a standalone Service class.
*   **Interactive**: Prompts to choose a target module or "Global / Shared".
*   **Custom Path**: Support direct path input (e.g., `Services/Aws`), casing is preserved for folders.
*   **Options**:
    *   `--path <path>`: Specify custom path directly.

### `cem create repository <name>`
Generates a standalone Repository class.
*   **Interactive**: Prompts to choose a target module or "Global / Shared".
*   **Custom Path**: Support direct path input (e.g., `Repositories/Order`), casing is preserved for folders.
*   **Options**:
    *   `--path <path>`: Specify custom path directly.

### `cem list`
Displays a tree view of your project's modules and components.

### `cem remove module <name>`
Safely deletes a module and its contents (with confirmation prompt).

### `cem doctor`
Checks your development environment health (Node version, Prisma, config files, etc.).

### `cem prisma init`
*    Installs `prisma` and `@prisma/client`.
*    Runs `npx prisma init` to create `prisma/schema.prisma`.

### `cem prisma generate`
*   Runs `npx prisma generate` to update the Prisma Client.

## Folder Structure

A typical project generated by `cem` looks like this:

```
my-app/
├── src/
│   ├── common/
│   ├── config/
│   ├── modules/
│   │   ├── user/
│   │   │   ├── dto/
│   │   │   │   └── user.dto.ts
│   │   │   ├── user.controller.ts
│   │   │   ├── user.repository.ts
│   │   │   └── user.service.ts
│   │   └── auth/
│   ├── app.ts
│   └── main.ts
├── dist/
├── prisma/
├── package.json
└── tsconfig.json
```

## End-to-End Workflow: Creating a User CRUD

1.  **Define Schema**: Edit `prisma/schema.prisma`
    ```prisma
    model User {
      id    String @id @default(uuid())
      email String @unique
      name  String
    }
    ```
2.  **Generate Client**:
    ```bash
    cem prisma generate
    ```
3.  **Create Module**:
    ```bash
    cem create module user
    # Select "Yes" to use Standard User Template
    ```
4.  **Wire it up**: The Service and Controller are already pre-wired! Just start the server:
    ```bash
    npm run dev
    ```

## Roadmap

*   [x] `create service` independent command
*   [x] `create repository` independent command
*   [x] `create middleware` command (Coming soon)
*   [x] Standard Auth & User Templates
*   [x] `list` and `remove` commands
*   [ ] Automated repository generation from Prisma Schema
*   [ ] `generate crud` from Prisma Schema (Power Feature)

## Contributing

Contributions are welcome! Please look at the [CONTRIBUTING.md](CONTRIBUTING.md) file for details.

## License

Distributed under the MIT License. See `LICENSE` for more information.
